name: Custom Rom Builder Samsung Galaxy A02s/M02s (qcom)

on:
  push:
    branches:
      - main  # Change this to your desired branch
  workflow_dispatch:
    inputs:
      GSI:
        description: 'Direct link for GSI image'
        required: true
        default: 'https://sourceforge.net/projects/mystic-gsi-updates/files/Pixel/Pixel-cheetah-15-12620009-AB-20241112-MysticGSI.zip'        
      ARCH:
        description: 'Arm64 only'
        required: true
        default: '64'                
      NAME:
        description: 'Rom Name'
        required: true
        default: 'Pixel_15_SDM450_A02q_ARM64_Gapps'                

jobs:
  Build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4

    - name: Install Dependencies
      run: |
        sudo apt update
        sudo apt install -y zip xz-utils unzip p7zip-full wget
        
    - name: Preparing Files
      run: |
        wget https://sourceforge.net/projects/samsung-galaxy-a01-m01/files/sdm450.zip/download -O sdm450.zip
        git clone https://github.com/arthurpf-dev/repo
        unzip sdm450.zip
        rm -r sdm450.zip

    - name: Downloading your GSI
      run: |
        mkdir -p ./temp
        wget -P "./temp" "${{ github.event.inputs.GSI }}"
        chmod 755 *
        chmod 755 ./bin/*

    - name: Building
      run: |
        ./arm${{ github.event.inputs.ARCH }}_git
        
    - name: Uploading The Zip
      uses: actions/upload-artifact@v4
      with:
        name: ${{ github.event.inputs.NAME }}
        path: ./zip/Custom_Rom_SDM450.zip
        retention-days: 7
